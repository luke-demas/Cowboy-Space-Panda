<!DOCTYPE html><html><head><title>Cowboy Space Panda!</title><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui=1"><meta charset="UTF-8"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="description" content=""><link rel="manifest" href="manifest.json"><link rel="icon" type="image/png" href="icon64.png"><link rel="apple-touch-icon" sizes="180x180" href="icon180.png"><link rel="icon" type="image/png" sizes="32x32" href="icon32.png"><link rel="icon" type="image/png" sizes="16x16" href="icon16.png"><style>html,body {
  margin: 0;
  padding: 0;
  background-color: #000;
  overflow:hidden;
  font-family: Verdana;
}
.noselect {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
#canvaswrapper {
  text-align: center ;
}
</style><style>@font-face { font-family: "BitCell" ; src: url("fonts/BitCell.ttf") format("truetype"); }</style><script>window.fonts = ["BitCell"]</script></head><body class="noselect custom-cursor" oncontextmenu="return false;"><div id="canvaswrapper"></div><script type="text/javascript">var resources = {"images":[{"file":"blc.png","version":21,"size":532,"properties":{"frames":1,"fps":5}},{"file":"bottom.png","version":24,"size":402,"properties":{"frames":1,"fps":5}},{"file":"brc.png","version":24,"size":528,"properties":{"frames":1,"fps":5}},{"file":"icon.png","version":24,"size":555,"properties":{"frames":1,"fps":5}},{"file":"left.png","version":2,"size":440,"properties":{"frames":1,"fps":5}},{"file":"meteor.png","version":1,"size":4908,"properties":{"frames":12,"fps":5}},{"file":"player.png","version":2,"size":1671,"properties":{"frames":10,"fps":5}},{"file":"player1.png","version":1,"size":1585,"properties":{"frames":10,"fps":5}},{"file":"player1dead.png","version":1,"size":483,"properties":{"frames":1,"fps":5}},{"file":"player2.png","version":10,"size":3333,"properties":{"frames":10,"fps":5}},{"file":"player2dead.png","version":6,"size":480,"properties":{"frames":1,"fps":5}},{"file":"playercrown.png","version":17,"size":1615,"properties":{"frames":10,"fps":5}},{"file":"playercrown1.png","version":2,"size":1564,"properties":{"frames":10,"fps":5}},{"file":"playercrown1dead.png","version":1,"size":553,"properties":{"frames":1,"fps":5}},{"file":"playercrown2.png","version":22,"size":1566,"properties":{"frames":10,"fps":5}},{"file":"playercrown2dead.png","version":1,"size":551,"properties":{"frames":1,"fps":5}},{"file":"playercrowndead.png","version":4,"size":549,"properties":{"frames":1,"fps":5}},{"file":"playerdead.png","version":8,"size":456,"properties":{"frames":1,"fps":5}},{"file":"right.png","version":21,"size":423,"properties":{"frames":1,"fps":5}},{"file":"space.png","version":23,"size":242,"properties":{"frames":1,"fps":5}},{"file":"star.png","version":1,"size":3725,"properties":{"frames":18,"fps":10}},{"file":"tlc.png","version":23,"size":531,"properties":{"frames":1,"fps":5}},{"file":"top.png","version":21,"size":381,"properties":{"frames":1,"fps":5}},{"file":"trc.png","version":24,"size":531,"properties":{"frames":1,"fps":5}}],"assets":[],"maps":{"map":"{\"width\":16,\"height\":10,\"block_width\":32,\"block_height\":32,\"sprites\":[0,\"blc\",\"bottom\",\"brc\",\"left\",\"space\",\"right\",\"tlc\",\"top\",\"trc\"],\"data\":[1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9]}"},"sounds":[],"music":[]};
var graphics = "M1";

</script><script type="text/javascript">var orientation = 'landscape' ;
var aspect = '16x9' ;
var ms_libs = [] ;
window.skip_service_worker = true;
window.exported_project = true;
</script><script src="runner_v1_i.js"></script><script src="microengine.js"></script></body><script id="code" type="text/x-microscript">

// helper function to keep player in screen bounds
// from mrLman tutorials
clamp = function(value, lower_limit, upper_limit)
  local val = max(value, lower_limit)
  val = min(val, upper_limit)
  return val
end

// helper function to check distance between objects
// from mrLman tutorials
distance = function(x1, y1, x2, y2)
  local a = x2 - x1
  local b = y2 - y1
  local c = sqrt(pow(a, 2) + pow(b, 2))
  return c
end

// helper function for random range calculation
// from mrLman tutorials
randRange = function(low, high)
  return (high - low) * random.next() + low
end

// checks game mode selection
updateTitleScreen = function()
  if keyboard.LEFT then
    mode = "single"
  end
  if keyboard.RIGHT then
    mode = "multi"
  end
end

// draws the title screen
drawTitleScreen = function()
  screen.drawMap("map", 0, 0, 320, 200)
  screen.drawText("Cowboy Space Panda!", 0, 40, 30, "rgb(227,227,0)")
  screen.drawText("p1 hi-score: " + hiscore, -110, 90, 16, "rgb(0,255,255)")
  screen.drawText("p2 hi-score: " + hiscore2, 110, 90, 16,"rgb(255,0,85)")
  if hiscore >= 50 then
    screen.drawSprite("playercrown", player.x, player.y, 35, 35)
  else
    screen.drawSprite("player", player.x, player.y, 35, 35)
  end
  screen.drawText("press LEFT for single player                press RIGHT for multi player", 0, -40, 10, "rgb(227,227,0)")
end

// initializes player object
initPlayer = function()
  player = object end
  if mode == "single" then
    player.x = 0
    player.y = 0
  elsif mode == "multi" then
    player.x = -25
    player.y = 0
  end
  player.speed = 2
end

// initializes player 2 object
initPlayer2 = function()
  player2 = object end
  player2.x = 25
  player2.y = 0
  player2.speed = 2
end

// initializes star object
initStar = function()
  star = object end
  randomizeStarPos()
end

// initialize meteor objects
initMeteor = function()
  meteor1 = object
    x = 300
    y = 120
    speed = 1.5
  end
  meteor2 = object
    x = -300
    y = -120
    speed = 1.5
  end
  meteor3 = object
    x = 80
    y = 200
    speed = 1.5
  end
  meteor4 = object
    x = -80
    y = -200
    speed = 1.5
  end
end

// checks for player collisions
checkCollisions = function()
  // get points from stars
  if distance(player.x, player.y, star.x, star.y) < 20 then
    audio.beep("saw volume 50 duration 100 span 80 C5 G5 volume 40 C6")
    score += 1
    // getting to 50 points plays a special sound
    if score == 50 then
      audio.beep("saw volume 50 duration 100 span 80 C5 G5 volume 40 C6 C8 C6 G5 C5 C3")
    end
    randomizeStarPos()
  end
  
  // lose game from meteors
  if mode == "single" then
    if gameover < 1 then
      if distance(player.x, player.y, meteor1.x, meteor1.y) < 30 then
        drawEndScreen()
        flag1 = 1
      end
      if distance(player.x, player.y, meteor2.x, meteor2.y) < 30 then
        drawEndScreen()
        flag1 = 1
      end
      if distance(player.x, player.y, meteor3.x, meteor3.y) < 30 then
        drawEndScreen()
        flag1 = 1
      end
      if distance(player.x, player.y, meteor4.x, meteor4.y) < 30 then
        drawEndScreen()
        flag1 = 1
      end
    end
    
  // collision detection for multi player
  elsif mode == "multi" then
    // player 2 get points from stars
    if distance(player2.x, player2.y, star.x, star.y) < 20 then
      audio.beep("saw volume 50 duration 100 span 80 C5 G5 volume 40 C6")
      score2 += 1
      randomizeStarPos()
    end
    
    // only end game once both players have collided with meteors
    if gameover < 1 then
      if distance(player.x, player.y, meteor1.x, meteor1.y) < 30 then
        player.speed = 0
        flag1 = 1
      end
      if distance(player.x, player.y, meteor2.x, meteor2.y) < 30 then
        player.speed = 0
        flag1 = 1
      end
      if distance(player.x, player.y, meteor3.x, meteor3.y) < 30 then
        player.speed = 0
        flag1 = 1
      end
      if distance(player.x, player.y, meteor4.x, meteor4.y) < 30 then
        player.speed = 0
        flag1 = 1
      end
      if distance(player2.x, player2.y, meteor1.x, meteor1.y) < 30 then
        player2.speed = 0
        flag2 = 1
      end
      if distance(player2.x, player2.y, meteor2.x, meteor2.y) < 30 then
        player2.speed = 0
        flag2 = 1
      end
      if distance(player2.x, player2.y, meteor3.x, meteor3.y) < 30 then
        player2.speed = 0
        flag2 = 1
      end
      if distance(player2.x, player2.y, meteor4.x, meteor4.y) < 30 then
        player2.speed = 0
        flag2 = 1
      end
      
      // flags verify now inactive collision
      if flag1 == 1 and flag2 == 1 then
        drawEndScreen()
      end
    end
  end
end

// randomly place stars in play field
randomizeStarPos = function()
  star.x = randRange(-150, 150)
  star.y = randRange(-80, 80)
end

// game over screen
drawEndScreen = function()
  gameover = 1
  audio.beep("saw tempo 10000 volume 50 span 50 C3 to C5 to C2 to C4")
  player.speed = 0
  player2.speed = 0
  meteor1.speed = 0
  meteor2.speed = 0
  meteor3.speed = 0
  meteor4.speed = 0
end

// hi-score global variables to keep scores between inits
hiscore = 0
hiscore2 = 0

// init func
init = function()
  screen.setCursorVisible(false)
  mode = "title"
  initPlayer()
  initStar()
  initMeteor()
  score = 0
  score2 = 0
  flag1 = 0
  flag2 = 0
  gameover = 0
  initPlayer2()
end

// update func
update = function()
  // display title screen
  if mode == "title" then
    updateTitleScreen()
  
  // display single player and multi player modes
  elsif mode == "single" or mode == "multi" then
    // player movement controls
    if keyboard.ARROW_UP then
      player.y += player.speed
    end
    if keyboard.ARROW_DOWN then
      player.y -= player.speed
    end
    if keyboard.ARROW_RIGHT then
      player.x += player.speed
    end
    if keyboard.ARROW_LEFT then
      player.x -= player.speed
    end
    if gameover > 0 then
      if keyboard.SPACE then
        init()
      end
    end
  
    // keep player within game bounds
    player.x = clamp(player.x, -150, 150)
    player.y = clamp(player.y, -80, 80)
  
    // move meteors
    meteor1.y -= meteor1.speed
    if meteor1.y < -120 then
      meteor1.y = 120
      meteor1.x = randRange(-150, 150)
      meteor1.speed = randRange(1, 3)
    end
    meteor2.y += meteor2.speed
    if meteor2.y > 120 then
      meteor2.y = -120
      meteor2.x = randRange(-150, 150)
      meteor2.speed = randRange(1, 3)
    end
    meteor3.x -= meteor3.speed
    if meteor3.x < -190 then
      meteor3.y = randRange(-80, 80)
      meteor3.x = 190
      meteor3.speed = randRange(1, 3)
    end
    meteor4.x += meteor4.speed
    if meteor4.x > 190 then
      meteor4.y = randRange(-80, 80)
      meteor4.x = -190
      meteor4.speed = randRange(1, 3)
    end
  
    // check collisions
    checkCollisions()
  
    //update hi-score
    if score > hiscore then
      hiscore = score
    end
    
    // player 2 movement controls
    if keyboard.W then
      player2.y += player2.speed
    end
    if keyboard.S then
      player2.y -= player2.speed
    end
    if keyboard.D then
      player2.x += player2.speed
    end
    if keyboard.A then
      player2.x -= player2.speed
    end
  
    // keep player 2 within game bounds
    player2.x = clamp(player2.x, -150, 150)
    player2.y = clamp(player2.y, -80, 80)
    
    // update hi-score player 2
    if score2 > hiscore2 then
      hiscore2 = score2
    end
  end
end

// draw func
draw = function()
  // clear the screen
  screen.clear()
  
  // draw title screen
  if mode == "title" then
    drawTitleScreen()
    
  // draw single player screen
  elsif mode == "single" then
    // draw map
    screen.drawMap("map", 0, 0, 320, 200)
  
    // draw star
    screen.drawSprite("star", star.x, star.y, 15, 15)
  
    // draw panda
    // get crown hat if hi score reaches 50
    // change sprite upon game over
    if hiscore < 50 then
      if flag1 == 0 then
        screen.drawSprite("player", player.x, player.y, 35, 35)
      elsif flag1 == 1 then
        screen.drawSprite("playerdead", player.x, player.y, 35, 35)
      end
    else
      if flag1 == 0 then
        screen.drawSprite("playercrown", player.x, player.y, 35, 35)
      elsif flag1 == 1 then
        screen.drawSprite("playercrowndead", player.x, player.y, 35, 35)
      end
    end
  
    // draw meteors
    screen.drawSprite("meteor", meteor1.x, meteor1.y, 40)
    screen.drawSprite("meteor", meteor2.x, meteor2.y, 40)
    screen.drawSprite("meteor", meteor3.x, meteor3.y, 40)
    screen.drawSprite("meteor", meteor4.x, meteor4.y, 40)
  
    // draw score
    screen.drawText("score: " + score, -127, 75, 16,"rgb(227,227,0)")
    screen.drawText("p1 hi-score: " + hiscore, -110, 90, 16, "rgb(0,255,255)") 

    // draw game over screen
    if gameover > 0 then
      screen.drawText("GAME OVER", 0, 30, 50, "rgb(277,277,0)")
      screen.drawText("Press space to restart.", 0, -40, 15, "rgb(277,277,0)")
    end
  
  // draw multi player screen
  elsif mode == "multi" then
    // draw map
    screen.drawMap("map", 0, 0, 320, 200)
  
    // draw star
    screen.drawSprite("star", star.x, star.y, 15, 15)
  
    // draw pandas
    // get crown hat if hi score reaches 50
    // change sprite upon game over
    if hiscore < 50 then
      if flag2 == 0 then
        screen.drawSprite("player2", player2.x, player2.y, 35, 35)
      elsif flag2 == 1 then
        screen.drawSprite("player2dead", player2.x, player2.y, 35, 35)
      end
    else
      if flag2 == 0 then
        screen.drawSprite("playercrown2", player2.x, player2.y, 35, 35)
      elsif flag2 == 1 then
        screen.drawSprite("playercrown2dead", player2.x, player2.y, 35, 35)
      end
    end
    if hiscore < 50 then
      if flag1 == 0 then
        screen.drawSprite("player1", player.x, player.y, 35, 35)
      elsif flag1 == 1 then
        screen.drawSprite("player1dead", player.x, player.y, 35, 35)
      end
    else
      if flag1 == 0 then
        screen.drawSprite("playercrown1", player.x, player.y, 35, 35)
      elsif flag1 == 1 then
        screen.drawSprite("playercrown1dead", player.x, player.y, 35, 35)
      end
    end
  
    // draw meteors
    screen.drawSprite("meteor", meteor1.x, meteor1.y, 40)
    screen.drawSprite("meteor", meteor2.x, meteor2.y, 40)
    screen.drawSprite("meteor", meteor3.x, meteor3.y, 40)
    screen.drawSprite("meteor", meteor4.x, meteor4.y, 40)
  
    // draw scores
    screen.drawText("score: " + score, -127, 75, 16,"rgb(227,227,0)")
    screen.drawText("p1 hi-score: " + hiscore, -110, 90, 16, "rgb(0,255,255)")
    screen.drawText("score: " + score2, 127, 75, 16,"rgb(227,227,0)")
    screen.drawText("p2 hi-score: " + hiscore2, 110, 90, 16, "rgb(255,0,85)")

    // draw game over screen
    // declare winner based on highest score
    if gameover > 0 then
      screen.drawText("GAME OVER", 0, 30, 50, "rgb(277,277,0)")
      if score > score2 then
        screen.drawText("Player 1 wins!", 0, -15, 25, "rgb(0,255,255)")
      elsif score2 > score then
        screen.drawText("Player 2 wins!", 0, -15, 25, "rgb(255,0,85)")
      else
        screen.drawText("Tie!", 0, -15, 25,"rgb(255,255,255)")
      end
      screen.drawText("Press space to restart.", 0, -40, 15, "rgb(277,277,0)")
    end
  end
end


</script></html>